<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' cdn.jsdelivr.net code.jquery.com cdnjs.cloudflare.com fonts.googleapis.com fonts.gstatic.com; script-src 'self' cdn.jsdelivr.net code.jquery.com 'unsafe-inline' cdnjs.cloudflare.com fonts.googleapis.com fonts.gstatic.com">
    <link rel="stylesheet" href="chessboard/css/chessboard-1.0.0.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="chessboard/js/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.2/chess.min.js"></script>
    <title>Chess Count Quiz</title>
    <link rel="stylesheet" href="chess-count-quiz.css">
    <style>
        .moves-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <h2>Chess Move Count Quiz</h2>
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
      <div class="modal-content">
        <span class="close-button">Ã—</span>
        <h2>Settings</h2>
        <form id="settingsForm">
          <!-- Settings options here -->
          <div>
            <label><input type="checkbox" id="showTimer">Enable Timer</label>
          </div>
	  <br>

	  <div>
	    Player to move:
	    <label><input type="radio" name="playerToMove" value="White">White</label>
	    <label><input type="radio" name="playerToMove" value="Black">Black</label>
	    <label><input type="radio" name="playerToMove" value="Random" checked>Random</label>
	  </div>
	  <br>

	  <div>
            <label><input type="checkbox" id="enableP1AllLegal" name="quizOption" value="p1AllLegal">Count all of player 1's legal moves</label>
          </div>
          <div>
            <label><input type="checkbox" id="enableP1Checks" name="quizOption" value="p1Checks">Count Player 1's checks</label>
          </div>
          <div>
            <label><input type="checkbox" id="enableP1Captures" name="quizOption" value="p1Captures">Count player 1's captures</label>
          </div>
	  <br>
	  
          <div>
            <label><input type="checkbox" id="enableP2AllLegal" name="quizOption" value="p2AllLegal">Count all of player 2's legal moves</label>
          </div>
          <div>
            <label><input type="checkbox" id="enableP2Checks" name="quizOption" value="p2Checks">Count player 2's checks</label>
          </div>
          <div>
            <label><input type="checkbox" id="enableP2Captures" name="quizOption" value="p2Captures">Count player 2's captures</label>
          </div>
	  <br>

          <div>
            <label>Plies ahead to visualize:
              <input type="number" id="plyAhead" min="0" max="10" value="0" style="width: 60px">
            </label>
          </div>
    <br>

          <button type="button" onclick="saveSettings()">Save Settings</button>
        </form>
      </div>
    </div>
    <button id="settingsButton">Settings</button>
    
    <div class="container">
      <div id="board" style="width: 400px"></div>
      <div class="info">
	<div id="score">Score: 0</div>
	<div id="remainingMoves"></div>

	<div id="timerSection">
	  <div id="timer">Time: 03:00</div>
	  <p>10 second penalty per wrong answer</p>
	</div>
	
	<form id="chessCountForm">
	  <div id="count-inputs">
	    <!-- Dynamic input fields will be appended here based on settings -->
	  </div>
	  <button type="submit" id="submit" class="action-button">Submit Counts</button>
	</form>
	<button id="showMovesButton" class="action-button">Show Moves</button>
      </div>
    </div>
    <P>Positions from the <a href="https://database.lichess.org/">Lichess puzzle database</a></p>
    <P>See <a href="https://github.com/bescoto/chess-count-quiz">https://github.com/bescoto/chess-count-quiz</a> for source code</p>
    <script src="chess-count-quiz.js"></script>
</body>
</html>

